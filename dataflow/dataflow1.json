{
	"name": "dataflow1",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "accountcsv",
						"type": "DatasetReference"
					},
					"name": "AccountData"
				},
				{
					"dataset": {
						"referenceName": "DimDistrict",
						"type": "DatasetReference"
					},
					"name": "DistrictData"
				},
				{
					"dataset": {
						"referenceName": "dimDate",
						"type": "DatasetReference"
					},
					"name": "DimDate"
				}
			],
			"sinks": [
				{
					"name": "AcccountDW"
				}
			],
			"transformations": [
				{
					"name": "LookUpForDistrictSK"
				},
				{
					"name": "DerivedColumn1"
				},
				{
					"name": "DateSKLookUp"
				}
			],
			"script": "source(output(\n\t\taccount_id as integer,\n\t\tdistrict_id as integer,\n\t\tfrequency as string,\n\t\tdate as date\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\twildcardPaths:['dbo.account.csv']) ~> AccountData\nsource(output(\n\t\tdistrict_sk as integer,\n\t\talternate_district_id as integer,\n\t\tA2 as string,\n\t\tA3 as string,\n\t\tA4 as integer,\n\t\tA5 as integer,\n\t\tA6 as integer,\n\t\tA7 as integer,\n\t\tA8 as integer,\n\t\tA9 as integer,\n\t\tA10 as decimal(5,1),\n\t\tA11 as integer,\n\t\tA12 as string,\n\t\tA13 as decimal(4,2),\n\t\tA14 as integer,\n\t\tA15 as string,\n\t\tA16 as integer,\n\t\tinsert_date as date,\n\t\tmodified_date as date\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table',\n\tstaged: true) ~> DistrictData\nsource(output(\n\t\tDateSK as integer,\n\t\tDate as date,\n\t\tDay as integer,\n\t\tMonthName as string,\n\t\tMonthNumber as integer,\n\t\tCalendarMonthLabel as string,\n\t\tYear as integer,\n\t\tISOWeekNumber as integer\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table',\n\tstaged: true) ~> DimDate\nDerivedColumn1, DistrictData lookup(district_id == alternate_district_id,\n\tmultiple: false,\n\tpickup: 'first',\n\tasc(alternate_district_id, true),\n\tbroadcast: 'auto')~> LookUpForDistrictSK\nAccountData derive(insertDate = currentTimestamp(),\n\t\tmodifiedDate = currentTimestamp()) ~> DerivedColumn1\nLookUpForDistrictSK, DimDate lookup(AccountData@date == split(toString(DimDate@Date), \"T\")[0],\n\tmultiple: false,\n\tpickup: 'first',\n\tasc(toString(DimDate@Date), true),\n\tbroadcast: 'auto')~> DateSKLookUp\nDateSKLookUp sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tmapColumn(\n\t\taccount_id,\n\t\tdistrict_id,\n\t\tfrequency,\n\t\tdate = AccountData@date,\n\t\tinsertDate,\n\t\tmodifiedDate,\n\t\tdistrict_sk,\n\t\talternate_district_id,\n\t\tA2,\n\t\tA3,\n\t\tA4,\n\t\tA5,\n\t\tA6,\n\t\tA7,\n\t\tA8,\n\t\tA9,\n\t\tA10,\n\t\tA11,\n\t\tA12,\n\t\tA13,\n\t\tA14,\n\t\tA15,\n\t\tA16,\n\t\tinsert_date,\n\t\tmodified_date,\n\t\tDateSK,\n\t\tDate = DimDate@Date,\n\t\tDay,\n\t\tMonthName,\n\t\tMonthNumber,\n\t\tCalendarMonthLabel,\n\t\tYear,\n\t\tISOWeekNumber\n\t)) ~> AcccountDW"
		}
	}
}